#!/bin/sh

##### background
#xsetroot -solid "$(xrdb -query|awk '/\*color0:/ {print $2}')"
#xsetroot -bitmap ${HOME}/.xfiles/background/bitmap-walls/patterns/line_diag8_1.xbm -bg "$(xrdb -query|awk '/\*color18:/ {print $2}')" -fg "$(xrdb -query|awk '/\*color8:/ {print $2}')"
#display -resize 1366x768\! -window root ${HOME}/.xfiles/background/wallpapers/fractals-leaf-caro.jpg
#display -size 1366x768 -window root ${HOME}/.xfiles/background/bitmap-walls/patterns/dots_wide.xbm

#hsetroot -tile ${HOME}/.xfiles/background/png-walls/dots16.png
hsetroot -fill $(cat ${HOME}/.xfiles/templer/wallpaper)
nice -n 15 xwinwrap -b -s -fs -st -sp -un -nf -ov -fdt -- gifview -w WID $(cat ${HOME}/.xfiles/templer/gif) -a 2> /dev/null &

picom --experimental-backends &

##### startup-screen
xbanish -a &
st -g 80x30+350+150 -e cbonsai -plt 0.005 -m " DWM" &
sleep 5 && killall cbonsai 2> /dev/null
killall xbanish

##### statusbar
internetav &
dwmblocks &
sh -c 'sleep 10 && kill -44 $(pidof dwmblocks)' &

##### polkit authentication agent (erst installieren)
/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &

##### set alsa-audio on startup with pulseaudio (not pipewire)
#audiosel alsa &

##### hide cursor
xbanish -m se -i mod4 &

##### notification - fondle
rm /tmp/notify
touch /tmp/notify
tiramisu -o "^c$(mondo get base08)^[#source]^d^ -- #summary -- #body" | while read -r notification; do
	echo $notification >> /tmp/notify
	xsetroot -name "msg: $notification"
done &

##### systray-applications
#suckless-python-menu 2> /dev/null & sleep 1 && nm-applet &
suckless-yad-menu 2> /dev/null && sleep 1 && nm-applet &

##### dwm (while loop for autorestart..)
rm ${HOME}/.cache/dwm.log
while true; do
    # Log stderror to a file 
    dwm 2> ${HOME}/.cache/dwm.log
    # No error logging
    #dwm >/dev/null 2>&1
done

#until dwm \
#2> ${HOME}/.config/dwm/dwm.log; do
#	sleep 1
#done
