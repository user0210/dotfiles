#!/bin/sh


# tmux-bell crashes process...
tmux set -g bell-action none


sessions=$(tmux ls 2> /dev/null | grep '^[1-9]\+:' | cut -f1 -d':')
for sess in $sessions
do
#	for i in {1..10}; do tmux send-keys -t $sess: 'C-['; done
	tmux send-keys -t $sess: 'C-['
	tmux send-keys -t $sess: C-z
	sleep 0.2
	tmux send-keys -t $sess: C-c
	sleep 0.2
	tmux send-keys -t $sess: "source ${HOME}/.zshrc; fg > /dev/null 2>&1 && tput cuu 7 || tput cuu 4" C-m
done
scratch=$(tmux ls 2> /dev/null | grep "scratchpad" | wc -l)
if [ "$scratch" -ne 0 ]; then
#	for i in {1..10}; do tmux send-keys -t scratchpad: 'C-['; done
	tmux send-keys -t scratchpad: 'C-['
	tmux send-keys -t scratchpad: C-z
	sleep 0.2
	tmux send-keys -t scratchpad: C-c
	sleep 0.2
	tmux send-keys -t scratchpad: "source ${HOME}/.zshrc; fg > /dev/null 2>&1 && tput cuu 7 || tput cuu 4" C-m
fi


#just for the tmux-bell...
tmux set -g bell-action any
