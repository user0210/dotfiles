#!/bin/sh

window=$(xdotool getactivewindow)

blockh=$(xprop -id $window | grep "specified minimum size" | grep -Eo '[0-9]+$')
font='monospace:bold:pixelsize='$((blockh=blockh-3))

nb=$(xrdb -query|awk '/\*color20:/ {print $2}')
nf=$(xrdb -query|awk '/\*color0:/ {print $2}')
sb=$(xrdb -query|awk '/\*color7:/ {print $2}')
hf=$(xrdb -query|awk '/\*color3:/ {print $2}')

prompt=' >_ '
line=0

while getopts ":p:l:" opt; do
  case $opt in
    p)
      prompt=$OPTARG
      ;;
    l)
      line=$OPTARG
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
    :)
      echo "Option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done


cat | dmenu -o 0 -i -w $window -l $line -p $prompt -fn $font \
	-nb $nb -nf $nf \
	-sb $sb -sf $nf \
	-nhb $nb -shb $sb \
	-nhf $hf -shf $hf \
